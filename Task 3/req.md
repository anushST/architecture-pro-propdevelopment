### Требования безопасности

| Контроль                      | Что требуется                                                                                                                                      | Зачем это нужно                                               |
| ----------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------- |
| Минимальные привилегии (PoLP) | Доступ партнёра ограничить только необходимыми API-операциями (двери/шлагбаумы) и только в пределах разрешённого периметра (конкретный ЖК).        | Исключает «выход за периметр» и ошибки разграничения доступа. |
| Аудит                         | Все действия доступа (авто/ручное открытие) фиксировать в **SmartHome Integration Service**: ID пользователя, время, объект/устройство, результат. | Нужно для расследований, контроля и требований регуляторов.   |
| Минимизация данных            | Передавать партнёру только то, без чего интеграция не работает: токены/хеши биометрии и номеров авто; не передавать полные ПДн.                    | Снижает последствия утечек и упрощает соблюдение **152-ФЗ**.  |
| Шифрование                    | Все чувствительные данные на стороне **партнёра** (биометрия, номера авто) хранить в зашифрованном виде с использованием стойких алгоритмов.       | Защита данных при компрометации внешнего хранилища.           |


### Аутентификация и авторизация

| Участники                                  | Механизм                          | Описание                                                                                 |
| ------------------------------------------ | --------------------------------- | ---------------------------------------------------------------------------------------- |
| **Собственник** → **Мобильное приложение** | **OAuth 2.0(Authorization Code)** | Пользователь проходит вход через авторизационный сервер и получает access/refresh токены |
| ** Service** → **Партнёр**                 | **OAuth 2.0 **                    | Токен с ограниченными правами (scopes) для вызова методов API партнёра.                  |
| **Service** ↔ **Партнёр**                  | **mTLS**                          | Взаимная проверка сертификатов: обе стороны однозначно идентифицируются.                 |


### Модель взаимодействия систем

| Поток                           | Что происходит                                                  | Режим                |
| ------------------------------- | --------------------------------------------------------------- | -------------------- |
| **Команды управления доступом** | Запрос на открытие домофона/шлагбаума по действию пользователя. | Синхронно (REST API) |
| **События и статусы**           | Партнёр отправляет события доступа и статусы устройств.         | Webhooks             |
